ipex flag is deprecated, will be removed in Accelerate v1.10. From 2.7.0, PyTorch has all needed optimizations for Intel CPU and XPU.
------------ Options -------------
abstractor: True
base_dim: 512
batch_size: 64
batch_size_eval: 32
beta_schedule: linear
cfg_scale: 2.5
cfg_scheduler_type: none
checkpoints_dir: ./checkpoints
clip_grad_norm: 1
cond_mask_prob: 0.1
continue_ckpt: latest.tar
dataset_name: t2m
decay_rate: 0.9
diffuser_name: dpmsolver
diffusion_steps: 1000
dim_mults: [2, 2, 2, 2]
disable_sta: False
diversity_times: 300
dropout: 0.1
enable_cfg_scheduler: False
enable_trace: False
eval_meta_dir: ./data
evaluator_dir: ./data/pretrained_models
evl_mode: fid
feat_bias: 5
glove_dir: ./data/glove
is_continue: False
laten_size: 77
latent_dim: 512
log_every: 500
lr: 0.0001
mm_num_repeats: 30
mm_num_samples: 100
mm_num_times: 10
model_ema: False
model_ema_decay: 0.9999
model_ema_steps: 32
name: ant_t2m
no_adagn: False
no_eff: False
no_ema: False
no_fp16: False
num_inference_steps: 10
num_layers: 8
num_train_steps: 150000
opt_path: 
prediction_type: sample
replication_times: 20
save_interval: 5000
seed: 0
text_encoder_type: t5
text_latent_dim: 256
time_dim: 512
update_lr_steps: 5000
use_text_cache: True
weight_decay: 0.01
which_ckpt: latest_120000
-------------- End ----------------

 Loading train mode HumanML3D train dataset ...
  0%|          | 0/23384 [00:00<?, ?it/s]  1%|▏         | 307/23384 [00:00<00:07, 3067.84it/s]  3%|▎         | 672/23384 [00:00<00:06, 3407.28it/s]  4%|▍         | 1052/23384 [00:00<00:06, 3583.93it/s]  6%|▌         | 1430/23384 [00:00<00:05, 3660.09it/s]  8%|▊         | 1806/23384 [00:00<00:05, 3694.90it/s]  9%|▉         | 2176/23384 [00:00<00:06, 3176.82it/s] 11%|█         | 2505/23384 [00:01<00:29, 703.60it/s]  12%|█▏        | 2735/23384 [00:03<00:56, 362.68it/s] 12%|█▏        | 2896/23384 [00:03<00:53, 385.09it/s] 13%|█▎        | 3023/23384 [00:04<00:58, 349.40it/s] 13%|█▎        | 3119/23384 [00:04<01:02, 325.04it/s] 14%|█▎        | 3193/23384 [00:05<01:03, 316.11it/s] 14%|█▍        | 3253/23384 [00:05<01:02, 324.05it/s] 14%|█▍        | 3316/23384 [00:05<00:56, 354.22it/s] 14%|█▍        | 3372/23384 [00:05<00:53, 374.58it/s] 15%|█▍        | 3426/23384 [00:05<00:55, 361.19it/s] 15%|█▍        | 3474/23384 [00:05<00:56, 354.20it/s] 15%|█▌        | 3517/23384 [00:05<00:59, 334.60it/s] 15%|█▌        | 3556/23384 [00:06<01:03, 312.53it/s] 15%|█▌        | 3591/23384 [00:06<01:08, 290.78it/s] 16%|█▌        | 3636/23384 [00:06<01:01, 322.82it/s] 16%|█▌        | 3676/23384 [00:06<00:59, 333.15it/s] 16%|█▌        | 3733/23384 [00:06<00:50, 388.46it/s] 16%|█▌        | 3775/23384 [00:06<00:59, 331.12it/s] 16%|█▋        | 3814/23384 [00:06<00:57, 339.85it/s] 16%|█▋        | 3851/23384 [00:07<01:02, 311.75it/s] 17%|█▋        | 3891/23384 [00:07<00:59, 329.03it/s] 17%|█▋        | 3926/23384 [00:07<01:03, 305.42it/s] 17%|█▋        | 3958/23384 [00:07<01:05, 297.06it/s] 17%|█▋        | 3989/23384 [00:07<01:10, 276.47it/s] 17%|█▋        | 4018/23384 [00:07<01:17, 249.87it/s] 17%|█▋        | 4084/23384 [00:07<00:57, 334.79it/s] 18%|█▊        | 4135/23384 [00:07<00:51, 372.52it/s] 18%|█▊        | 4174/23384 [00:07<00:52, 364.25it/s] 18%|█▊        | 4212/23384 [00:08<00:55, 343.11it/s] 18%|█▊        | 4248/23384 [00:08<00:58, 325.85it/s] 18%|█▊        | 4293/23384 [00:08<00:53, 354.02it/s] 19%|█▊        | 4346/23384 [00:08<00:49, 388.01it/s] 19%|█▉        | 4386/23384 [00:08<00:52, 359.21it/s] 19%|█▉        | 4423/23384 [00:08<01:05, 288.27it/s] 19%|█▉        | 4499/23384 [00:08<00:48, 386.82it/s] 19%|█▉        | 4542/23384 [00:09<00:57, 325.55it/s] 20%|█▉        | 4579/23384 [00:09<01:03, 294.87it/s] 20%|█▉        | 4612/23384 [00:09<01:04, 292.24it/s] 20%|█▉        | 4644/23384 [00:09<01:03, 297.35it/s] 20%|█▉        | 4676/23384 [00:09<01:02, 298.34it/s] 20%|██        | 4717/23384 [00:09<00:57, 324.31it/s] 20%|██        | 4751/23384 [00:09<01:03, 291.61it/s] 21%|██        | 4798/23384 [00:09<00:55, 334.36it/s] 21%|██        | 4833/23384 [00:10<00:57, 324.38it/s] 21%|██        | 4879/23384 [00:10<00:52, 353.91it/s] 21%|██        | 4916/23384 [00:10<01:10, 260.53it/s] 21%|██        | 4947/23384 [00:10<01:20, 229.46it/s] 21%|██▏       | 4974/23384 [00:10<01:28, 207.16it/s] 21%|██▏       | 5004/23384 [00:10<01:22, 223.01it/s] 22%|██▏       | 5036/23384 [00:10<01:15, 244.42it/s] 22%|██▏       | 5063/23384 [00:11<01:25, 214.40it/s] 22%|██▏       | 5145/23384 [00:11<00:52, 346.51it/s] 22%|██▏       | 5185/23384 [00:11<01:17, 233.78it/s] 22%|██▏       | 5217/23384 [00:11<01:23, 216.85it/s] 22%|██▏       | 5245/23384 [00:12<01:46, 169.88it/s] 23%|██▎       | 5267/23384 [00:12<02:11, 137.52it/s] 23%|██▎       | 5285/23384 [00:12<02:21, 128.20it/s] 23%|██▎       | 5301/23384 [00:12<02:15, 133.33it/s] 23%|██▎       | 5317/23384 [00:12<02:21, 128.00it/s] 23%|██▎       | 5332/23384 [00:12<02:43, 110.53it/s] 23%|██▎       | 5345/23384 [00:13<02:57, 101.79it/s] 23%|██▎       | 5356/23384 [00:13<03:01, 99.10it/s]  23%|██▎       | 5378/23384 [00:13<02:25, 123.64it/s] 23%|██▎       | 5399/23384 [00:13<02:09, 138.70it/s] 23%|██▎       | 5414/23384 [00:13<02:15, 133.08it/s] 23%|██▎       | 5444/23384 [00:13<01:47, 166.23it/s] 23%|██▎       | 5462/23384 [00:13<02:03, 145.43it/s] 23%|██▎       | 5478/23384 [00:13<02:15, 132.30it/s] 24%|██▎       | 5497/23384 [00:14<02:08, 139.25it/s] 24%|██▎       | 5512/23384 [00:14<02:11, 135.71it/s] 24%|██▎       | 5526/23384 [00:14<02:10, 136.74it/s] 24%|██▎       | 5542/23384 [00:14<02:05, 142.33it/s] 24%|██▍       | 5557/23384 [00:14<02:06, 141.35it/s] 24%|██▍       | 5573/23384 [00:14<02:03, 144.06it/s] 24%|██▍       | 5593/23384 [00:14<01:52, 158.33it/s] 24%|██▍       | 5610/23384 [00:14<01:58, 149.96it/s] 24%|██▍       | 5637/23384 [00:14<01:38, 180.41it/s] 24%|██▍       | 5659/23384 [00:15<01:37, 181.30it/s] 24%|██▍       | 5678/23384 [00:15<01:46, 165.53it/s] 24%|██▍       | 5695/23384 [00:15<01:47, 164.16it/s] 24%|██▍       | 5720/23384 [00:15<01:39, 177.38it/s] 25%|██▍       | 5738/23384 [00:15<01:43, 171.09it/s] 25%|██▍       | 5756/23384 [00:15<01:42, 172.50it/s] 25%|██▍       | 5774/23384 [00:15<01:43, 169.82it/s] 25%|██▍       | 5792/23384 [00:15<01:51, 157.51it/s] 25%|██▍       | 5808/23384 [00:16<01:52, 155.74it/s] 25%|██▍       | 5830/23384 [00:16<01:41, 172.77it/s] 25%|██▌       | 5848/23384 [00:16<01:56, 151.05it/s] 25%|██▌       | 5864/23384 [00:16<01:55, 151.62it/s] 25%|██▌       | 5907/23384 [00:16<01:19, 219.49it/s] 25%|██▌       | 5930/23384 [00:16<01:31, 191.16it/s] 25%|██▌       | 5955/23384 [00:16<01:25, 203.99it/s] 26%|██▌       | 5977/23384 [00:16<01:25, 204.55it/s] 26%|██▌       | 5999/23384 [00:16<01:24, 206.70it/s] 26%|██▌       | 6021/23384 [00:17<01:30, 192.04it/s] 26%|██▌       | 6041/23384 [00:17<01:35, 182.28it/s] 26%|██▌       | 6060/23384 [00:17<01:48, 159.26it/s] 26%|██▌       | 6077/23384 [00:17<01:47, 161.59it/s] 26%|██▌       | 6117/23384 [00:17<01:17, 222.88it/s] 26%|██▋       | 6141/23384 [00:17<01:20, 214.60it/s] 26%|██▋       | 6164/23384 [00:17<01:34, 181.40it/s] 26%|██▋       | 6184/23384 [00:18<01:56, 147.93it/s] 27%|██▋       | 6201/23384 [00:18<02:06, 136.28it/s] 27%|██▋       | 6216/23384 [00:18<02:18, 123.84it/s] 27%|██▋       | 6249/23384 [00:18<01:43, 165.58it/s] 27%|██▋       | 6277/23384 [00:18<01:30, 188.64it/s] 27%|██▋       | 6298/23384 [00:18<01:44, 163.29it/s] 27%|██▋       | 6328/23384 [00:18<01:27, 194.43it/s] 27%|██▋       | 6351/23384 [00:19<01:28, 193.17it/s] 27%|██▋       | 6372/23384 [00:19<01:43, 163.59it/s] 27%|██▋       | 6395/23384 [00:19<01:36, 176.20it/s] 27%|██▋       | 6415/23384 [00:19<01:47, 158.52it/s] 28%|██▊       | 6448/23384 [00:19<01:27, 194.62it/s] 28%|██▊       | 6470/23384 [00:19<01:35, 177.19it/s] 28%|██▊       | 6492/23384 [00:19<01:34, 178.83it/s] 28%|██▊       | 6523/23384 [00:19<01:23, 203.01it/s] 28%|██▊       | 6548/23384 [00:20<01:20, 208.32it/s] 28%|██▊       | 6574/23384 [00:20<01:18, 214.08it/s] 28%|██▊       | 6596/23384 [00:20<01:20, 207.74it/s] 29%|██▊       | 6672/23384 [00:20<00:47, 354.14it/s] 29%|██▊       | 6710/23384 [00:20<00:52, 315.78it/s] 29%|██▉       | 6744/23384 [00:20<01:23, 200.15it/s] 29%|██▉       | 6771/23384 [00:21<01:29, 186.11it/s] 29%|██▉       | 6795/23384 [00:21<01:33, 177.59it/s] 29%|██▉       | 6816/23384 [00:21<01:30, 183.29it/s] 29%|██▉       | 6877/23384 [00:21<01:00, 273.58it/s] 30%|██▉       | 6938/23384 [00:21<00:46, 352.12it/s] 30%|██▉       | 6989/23384 [00:21<00:42, 384.18it/s] 30%|███       | 7032/23384 [00:21<00:58, 280.19it/s] 30%|███       | 7067/23384 [00:22<01:01, 265.66it/s] 30%|███       | 7099/23384 [00:22<01:03, 255.91it/s] 30%|███       | 7128/23384 [00:22<01:11, 227.89it/s] 31%|███       | 7154/23384 [00:22<01:29, 181.52it/s] 31%|███       | 7200/23384 [00:22<01:09, 234.39it/s] 31%|███       | 7229/23384 [00:22<01:06, 241.61it/s] 31%|███       | 7257/23384 [00:22<01:05, 246.80it/s] 31%|███       | 7285/23384 [00:23<01:23, 193.49it/s] 31%|███▏      | 7326/23384 [00:23<01:07, 238.30it/s] 31%|███▏      | 7355/23384 [00:23<01:15, 211.25it/s] 32%|███▏      | 7380/23384 [00:23<01:46, 149.66it/s] 32%|███▏      | 7400/23384 [00:23<01:45, 152.21it/s] 32%|███▏      | 7419/23384 [00:24<01:46, 149.89it/s] 32%|███▏      | 7438/23384 [00:24<01:41, 156.36it/s] 32%|███▏      | 7465/23384 [00:24<01:29, 177.47it/s] 32%|███▏      | 7519/23384 [00:24<01:01, 259.23it/s] 32%|███▏      | 7548/23384 [00:24<01:02, 251.44it/s] 33%|███▎      | 7603/23384 [00:24<00:48, 326.74it/s] 33%|███▎      | 7646/23384 [00:24<00:46, 342.07it/s] 33%|███▎      | 7683/23384 [00:24<00:55, 284.19it/s] 33%|███▎      | 7789/23384 [00:24<00:33, 467.36it/s] 34%|███▎      | 7843/23384 [00:25<01:03, 244.60it/s] 34%|███▍      | 8031/23384 [00:25<00:30, 495.97it/s] 35%|███▌      | 8248/23384 [00:25<00:18, 796.76it/s] 36%|███▌      | 8420/23384 [00:25<00:15, 985.22it/s] 37%|███▋      | 8559/23384 [00:25<00:15, 938.91it/s] 37%|███▋      | 8736/23384 [00:26<00:13, 1121.04it/s] 38%|███▊      | 8941/23384 [00:26<00:10, 1341.42it/s] 39%|███▉      | 9150/23384 [00:26<00:09, 1530.19it/s] 40%|███▉      | 9352/23384 [00:26<00:08, 1659.14it/s] 41%|████      | 9557/23384 [00:26<00:07, 1765.56it/s] 42%|████▏     | 9746/23384 [00:27<00:28, 484.50it/s]  42%|████▏     | 9884/23384 [00:28<00:37, 360.95it/s] 43%|████▎     | 9987/23384 [00:28<00:39, 336.56it/s] 43%|████▎     | 10067/23384 [00:29<00:50, 261.20it/s] 43%|████▎     | 10127/23384 [00:29<00:51, 257.08it/s] 44%|████▎     | 10176/23384 [00:29<01:02, 212.80it/s] 44%|████▎     | 10214/23384 [00:30<01:07, 194.55it/s] 44%|████▍     | 10245/23384 [00:30<01:05, 201.06it/s] 44%|████▍     | 10274/23384 [00:30<01:07, 194.28it/s] 44%|████▍     | 10299/23384 [00:30<01:06, 196.05it/s] 44%|████▍     | 10327/23384 [00:30<01:02, 207.96it/s] 44%|████▍     | 10352/23384 [00:30<01:08, 190.44it/s] 44%|████▍     | 10374/23384 [00:31<01:18, 165.73it/s] 44%|████▍     | 10393/23384 [00:31<01:18, 165.82it/s] 45%|████▍     | 10425/23384 [00:31<01:06, 195.80it/s] 45%|████▍     | 10450/23384 [00:31<01:02, 205.30it/s] 45%|████▍     | 10473/23384 [00:31<01:13, 175.19it/s] 45%|████▍     | 10493/23384 [00:31<01:15, 169.94it/s] 45%|████▍     | 10512/23384 [00:31<01:14, 172.36it/s] 45%|████▌     | 10531/23384 [00:31<01:22, 155.81it/s] 45%|████▌     | 10556/23384 [00:32<01:14, 172.56it/s] 45%|████▌     | 10585/23384 [00:32<01:06, 193.40it/s] 46%|████▌     | 10658/23384 [00:32<00:38, 328.72it/s] 46%|████▌     | 10704/23384 [00:32<00:34, 362.99it/s] 46%|████▌     | 10743/23384 [00:32<00:38, 326.04it/s] 46%|████▌     | 10779/23384 [00:32<00:49, 253.36it/s] 46%|████▌     | 10809/23384 [00:32<00:54, 232.61it/s] 46%|████▋     | 10842/23384 [00:33<00:49, 251.53it/s] 46%|████▋     | 10870/23384 [00:33<00:55, 225.33it/s] 47%|████▋     | 10934/23384 [00:33<00:39, 318.74it/s] 47%|████▋     | 11029/23384 [00:33<00:26, 467.77it/s] 47%|████▋     | 11082/23384 [00:33<00:38, 317.38it/s] 48%|████▊     | 11125/23384 [00:33<00:41, 295.27it/s] 48%|████▊     | 11162/23384 [00:34<00:49, 247.49it/s] 48%|████▊     | 11193/23384 [00:34<00:56, 215.40it/s] 48%|████▊     | 11219/23384 [00:34<00:57, 213.40it/s] 48%|████▊     | 11244/23384 [00:34<00:55, 218.30it/s] 48%|████▊     | 11269/23384 [00:34<00:56, 215.45it/s] 48%|████▊     | 11293/23384 [00:34<01:05, 185.31it/s] 48%|████▊     | 11314/23384 [00:34<01:05, 183.88it/s] 49%|████▊     | 11343/23384 [00:35<00:58, 205.52it/s] 49%|████▊     | 11384/23384 [00:35<00:47, 250.89it/s] 49%|████▉     | 11411/23384 [00:35<01:08, 174.64it/s] 49%|████▉     | 11443/23384 [00:35<00:59, 201.62it/s] 49%|████▉     | 11468/23384 [00:35<01:07, 177.44it/s] 49%|████▉     | 11489/23384 [00:35<01:04, 183.39it/s] 49%|████▉     | 11510/23384 [00:36<01:10, 168.19it/s] 49%|████▉     | 11546/23384 [00:36<00:56, 211.01it/s] 50%|████▉     | 11600/23384 [00:36<00:40, 290.72it/s] 50%|████▉     | 11651/23384 [00:36<00:35, 334.46it/s] 50%|████▉     | 11688/23384 [00:36<00:35, 331.40it/s] 50%|█████     | 11724/23384 [00:36<00:34, 338.52it/s] 50%|█████     | 11760/23384 [00:36<00:44, 258.93it/s] 51%|█████     | 11811/23384 [00:36<00:36, 315.80it/s] 51%|█████     | 11890/23384 [00:36<00:27, 423.44it/s] 51%|█████     | 11938/23384 [00:37<00:31, 358.89it/s] 51%|█████     | 11979/23384 [00:37<00:40, 283.29it/s] 51%|█████▏    | 12013/23384 [00:37<00:43, 258.48it/s] 52%|█████▏    | 12043/23384 [00:37<00:47, 237.06it/s] 52%|█████▏    | 12070/23384 [00:37<00:47, 240.10it/s] 52%|█████▏    | 12096/23384 [00:37<00:47, 236.64it/s] 52%|█████▏    | 12121/23384 [00:38<01:01, 184.27it/s] 52%|█████▏    | 12142/23384 [00:38<01:06, 169.64it/s] 52%|█████▏    | 12206/23384 [00:38<00:41, 266.35it/s] 52%|█████▏    | 12238/23384 [00:38<00:53, 210.13it/s] 52%|█████▏    | 12266/23384 [00:38<00:50, 221.59it/s] 53%|█████▎    | 12293/23384 [00:38<00:50, 217.87it/s] 53%|█████▎    | 12318/23384 [00:39<00:51, 215.91it/s] 53%|█████▎    | 12342/23384 [00:39<00:51, 214.08it/s] 53%|█████▎    | 12392/23384 [00:39<00:38, 284.44it/s] 53%|█████▎    | 12423/23384 [00:39<00:48, 227.46it/s] 53%|█████▎    | 12481/23384 [00:39<00:36, 300.05it/s] 54%|█████▎    | 12516/23384 [00:39<00:47, 230.61it/s] 54%|█████▍    | 12608/23384 [00:39<00:30, 357.98it/s] 54%|█████▍    | 12652/23384 [00:40<00:33, 317.99it/s] 54%|█████▍    | 12690/23384 [00:40<00:36, 290.59it/s] 54%|█████▍    | 12724/23384 [00:40<00:35, 299.22it/s] 55%|█████▍    | 12775/23384 [00:40<00:31, 338.04it/s] 55%|█████▌    | 12921/23384 [00:40<00:17, 585.91it/s] 56%|█████▌    | 12985/23384 [00:41<00:33, 314.03it/s] 56%|█████▋    | 13175/23384 [00:41<00:18, 562.48it/s] 57%|█████▋    | 13266/23384 [00:41<00:16, 613.39it/s] 57%|█████▋    | 13412/23384 [00:41<00:12, 785.66it/s] 58%|█████▊    | 13559/23384 [00:41<00:10, 939.55it/s] 59%|█████▉    | 13761/23384 [00:41<00:08, 1201.50it/s] 60%|█████▉    | 13979/23384 [00:41<00:06, 1378.88it/s] 60%|██████    | 14133/23384 [00:42<00:22, 411.53it/s]  61%|██████    | 14246/23384 [00:42<00:19, 458.24it/s] 61%|██████▏   | 14347/23384 [00:43<00:19, 460.42it/s] 62%|██████▏   | 14432/23384 [00:43<00:26, 331.74it/s] 62%|██████▏   | 14501/23384 [00:43<00:24, 369.54it/s] 62%|██████▏   | 14567/23384 [00:44<00:28, 312.96it/s] 63%|██████▎   | 14619/23384 [00:44<00:27, 321.08it/s] 63%|██████▎   | 14667/23384 [00:44<00:28, 308.46it/s] 63%|██████▎   | 14708/23384 [00:44<00:29, 292.85it/s] 63%|██████▎   | 14746/23384 [00:44<00:28, 307.48it/s] 63%|██████▎   | 14783/23384 [00:44<00:28, 299.19it/s] 63%|██████▎   | 14834/23384 [00:44<00:25, 330.29it/s] 64%|██████▎   | 14898/23384 [00:45<00:21, 398.60it/s] 64%|██████▍   | 14943/23384 [00:45<00:26, 319.12it/s] 64%|██████▍   | 14981/23384 [00:45<00:26, 314.08it/s] 64%|██████▍   | 15017/23384 [00:45<00:27, 305.74it/s] 64%|██████▍   | 15051/23384 [00:45<00:26, 312.03it/s] 65%|██████▍   | 15085/23384 [00:45<00:28, 293.68it/s] 65%|██████▍   | 15122/23384 [00:45<00:26, 308.51it/s] 65%|██████▍   | 15155/23384 [00:46<00:32, 256.74it/s] 65%|██████▍   | 15184/23384 [00:46<00:31, 257.50it/s] 65%|██████▌   | 15219/23384 [00:46<00:29, 278.88it/s] 65%|██████▌   | 15249/23384 [00:46<00:31, 255.19it/s] 65%|██████▌   | 15276/23384 [00:46<00:33, 243.99it/s] 65%|██████▌   | 15305/23384 [00:46<00:32, 250.35it/s] 66%|██████▌   | 15331/23384 [00:46<00:33, 237.76it/s] 66%|██████▌   | 15356/23384 [00:46<00:36, 222.78it/s] 66%|██████▌   | 15386/23384 [00:46<00:33, 241.87it/s] 66%|██████▌   | 15417/23384 [00:47<00:31, 253.71it/s] 66%|██████▌   | 15443/23384 [00:47<00:36, 215.30it/s] 66%|██████▌   | 15466/23384 [00:47<00:37, 212.69it/s] 66%|██████▌   | 15489/23384 [00:47<00:48, 164.04it/s] 66%|██████▋   | 15514/23384 [00:47<00:44, 178.70it/s] 66%|██████▋   | 15549/23384 [00:47<00:36, 213.84it/s] 67%|██████▋   | 15573/23384 [00:47<00:41, 187.65it/s] 67%|██████▋   | 15594/23384 [00:48<00:43, 179.03it/s] 67%|██████▋   | 15614/23384 [00:48<00:43, 176.63it/s] 67%|██████▋   | 15641/23384 [00:48<00:39, 195.95it/s] 67%|██████▋   | 15679/23384 [00:48<00:32, 238.13it/s] 67%|██████▋   | 15714/23384 [00:48<00:29, 260.69it/s] 67%|██████▋   | 15742/23384 [00:48<00:34, 221.11it/s] 67%|██████▋   | 15766/23384 [00:48<00:34, 219.68it/s] 68%|██████▊   | 15790/23384 [00:48<00:36, 207.69it/s] 68%|██████▊   | 15812/23384 [00:49<00:39, 189.60it/s] 68%|██████▊   | 15832/23384 [00:49<00:40, 185.10it/s] 68%|██████▊   | 15851/23384 [00:49<00:50, 148.29it/s] 68%|██████▊   | 15875/23384 [00:49<00:44, 168.31it/s] 68%|██████▊   | 15917/23384 [00:49<00:33, 220.45it/s] 68%|██████▊   | 15947/23384 [00:49<00:31, 237.50it/s] 68%|██████▊   | 15973/23384 [00:49<00:40, 183.14it/s] 68%|██████▊   | 16007/23384 [00:50<00:34, 211.40it/s] 69%|██████▊   | 16031/23384 [00:50<00:39, 186.23it/s] 69%|██████▉   | 16186/23384 [00:50<00:14, 483.45it/s] 69%|██████▉   | 16246/23384 [00:50<00:20, 349.01it/s] 70%|██████▉   | 16294/23384 [00:51<00:30, 235.88it/s] 70%|███████   | 16432/23384 [00:51<00:17, 391.70it/s] 71%|███████   | 16506/23384 [00:51<00:15, 449.15it/s] 71%|███████   | 16604/23384 [00:51<00:12, 548.06it/s] 71%|███████▏  | 16678/23384 [00:51<00:13, 496.21it/s] 72%|███████▏  | 16742/23384 [00:51<00:12, 518.74it/s] 72%|███████▏  | 16808/23384 [00:51<00:11, 549.72it/s] 72%|███████▏  | 16872/23384 [00:52<00:14, 450.08it/s] 73%|███████▎  | 17054/23384 [00:52<00:08, 726.63it/s] 73%|███████▎  | 17141/23384 [00:52<00:17, 360.27it/s] 74%|███████▎  | 17207/23384 [00:52<00:16, 385.60it/s] 74%|███████▍  | 17346/23384 [00:52<00:11, 542.56it/s] 75%|███████▌  | 17546/23384 [00:53<00:07, 808.26it/s] 76%|███████▌  | 17665/23384 [00:53<00:08, 711.78it/s] 76%|███████▋  | 17861/23384 [00:53<00:05, 921.10it/s] 77%|███████▋  | 17981/23384 [00:54<00:12, 422.40it/s] 77%|███████▋  | 18070/23384 [00:54<00:12, 440.24it/s] 78%|███████▊  | 18148/23384 [00:54<00:12, 418.36it/s] 78%|███████▊  | 18214/23384 [00:54<00:12, 415.09it/s] 78%|███████▊  | 18272/23384 [00:55<00:16, 306.49it/s] 78%|███████▊  | 18317/23384 [00:55<00:17, 295.02it/s] 79%|███████▊  | 18357/23384 [00:55<00:18, 274.23it/s] 79%|███████▊  | 18391/23384 [00:55<00:23, 210.92it/s] 79%|███████▉  | 18418/23384 [00:55<00:23, 208.67it/s] 79%|███████▉  | 18450/23384 [00:55<00:21, 226.46it/s] 79%|███████▉  | 18477/23384 [00:56<00:24, 201.26it/s] 79%|███████▉  | 18501/23384 [00:56<00:25, 189.09it/s] 79%|███████▉  | 18522/23384 [00:56<00:25, 187.01it/s] 79%|███████▉  | 18553/23384 [00:56<00:22, 210.81it/s] 79%|███████▉  | 18576/23384 [00:56<00:22, 213.36it/s] 80%|███████▉  | 18603/23384 [00:56<00:21, 221.10it/s] 80%|███████▉  | 18627/23384 [00:56<00:24, 193.83it/s] 80%|███████▉  | 18648/23384 [00:57<00:24, 191.63it/s] 80%|███████▉  | 18668/23384 [00:57<00:24, 193.20it/s] 80%|███████▉  | 18689/23384 [00:57<00:24, 194.63it/s] 80%|████████  | 18754/23384 [00:57<00:15, 307.15it/s] 80%|████████  | 18786/23384 [00:57<00:17, 261.41it/s] 80%|████████  | 18814/23384 [00:57<00:18, 249.86it/s] 81%|████████  | 18840/23384 [00:57<00:20, 224.20it/s] 81%|████████  | 18864/23384 [00:57<00:20, 224.96it/s] 81%|████████  | 18914/23384 [00:58<00:15, 282.19it/s] 81%|████████  | 18946/23384 [00:58<00:15, 287.73it/s] 81%|████████  | 18976/23384 [00:58<00:19, 224.49it/s] 81%|████████▏ | 19001/23384 [00:58<00:21, 208.46it/s] 81%|████████▏ | 19051/23384 [00:58<00:15, 274.03it/s] 82%|████████▏ | 19174/23384 [00:58<00:08, 507.21it/s] 83%|████████▎ | 19309/23384 [00:58<00:05, 709.02it/s] 83%|████████▎ | 19388/23384 [00:59<00:07, 528.53it/s] 83%|████████▎ | 19453/23384 [00:59<00:08, 489.43it/s] 84%|████████▎ | 19533/23384 [00:59<00:06, 555.42it/s] 84%|████████▍ | 19610/23384 [00:59<00:06, 592.79it/s] 84%|████████▍ | 19676/23384 [00:59<00:10, 367.66it/s] 85%|████████▍ | 19853/23384 [00:59<00:05, 612.95it/s] 86%|████████▌ | 20019/23384 [00:59<00:04, 821.88it/s] 86%|████████▌ | 20131/23384 [01:00<00:04, 656.19it/s] 86%|████████▋ | 20223/23384 [01:00<00:05, 577.97it/s] 87%|████████▋ | 20300/23384 [01:00<00:05, 595.09it/s] 87%|████████▋ | 20374/23384 [01:00<00:05, 561.41it/s] 87%|████████▋ | 20440/23384 [01:00<00:05, 569.43it/s] 88%|████████▊ | 20580/23384 [01:00<00:03, 754.25it/s] 89%|████████▊ | 20710/23384 [01:01<00:03, 877.58it/s] 89%|████████▉ | 20809/23384 [01:01<00:03, 680.00it/s] 89%|████████▉ | 20891/23384 [01:01<00:06, 401.07it/s] 90%|████████▉ | 20954/23384 [01:02<00:07, 330.13it/s] 90%|████████▉ | 21021/23384 [01:02<00:06, 376.70it/s] 90%|█████████ | 21076/23384 [01:02<00:06, 359.90it/s] 90%|█████████ | 21124/23384 [01:02<00:06, 358.39it/s] 91%|█████████ | 21185/23384 [01:02<00:05, 393.61it/s] 91%|█████████ | 21245/23384 [01:02<00:04, 436.06it/s] 91%|█████████ | 21296/23384 [01:03<00:07, 269.85it/s] 91%|█████████ | 21336/23384 [01:03<00:07, 265.00it/s] 91%|█████████▏| 21371/23384 [01:03<00:08, 243.60it/s] 92%|█████████▏| 21402/23384 [01:03<00:08, 239.65it/s] 92%|█████████▏| 21430/23384 [01:03<00:08, 234.13it/s] 92%|█████████▏| 21456/23384 [01:03<00:09, 206.82it/s] 92%|█████████▏| 21479/23384 [01:04<00:09, 195.16it/s] 92%|█████████▏| 21500/23384 [01:04<00:10, 186.41it/s] 92%|█████████▏| 21521/23384 [01:04<00:09, 187.47it/s] 92%|█████████▏| 21541/23384 [01:04<00:10, 182.65it/s] 93%|█████████▎| 21653/23384 [01:04<00:04, 399.57it/s] 93%|█████████▎| 21696/23384 [01:04<00:04, 396.71it/s] 93%|█████████▎| 21829/23384 [01:04<00:02, 637.88it/s] 94%|█████████▎| 21898/23384 [01:04<00:02, 533.45it/s] 94%|█████████▍| 21958/23384 [01:05<00:03, 431.72it/s] 94%|█████████▍| 22009/23384 [01:05<00:04, 328.56it/s] 94%|█████████▍| 22050/23384 [01:05<00:04, 296.73it/s] 94%|█████████▍| 22086/23384 [01:05<00:04, 303.66it/s] 95%|█████████▍| 22121/23384 [01:05<00:04, 265.56it/s] 95%|█████████▍| 22151/23384 [01:05<00:04, 258.40it/s] 95%|█████████▍| 22179/23384 [01:06<00:04, 262.14it/s] 95%|█████████▍| 22212/23384 [01:06<00:04, 277.77it/s] 95%|█████████▌| 22242/23384 [01:06<00:04, 255.60it/s] 95%|█████████▌| 22269/23384 [01:06<00:05, 215.89it/s] 95%|█████████▌| 22293/23384 [01:06<00:04, 218.49it/s] 96%|█████████▌| 22341/23384 [01:06<00:03, 277.52it/s] 96%|█████████▌| 22371/23384 [01:06<00:03, 256.18it/s] 96%|█████████▌| 22399/23384 [01:06<00:03, 256.60it/s] 96%|█████████▌| 22442/23384 [01:07<00:03, 298.13it/s] 96%|█████████▌| 22474/23384 [01:07<00:03, 282.96it/s] 96%|█████████▌| 22504/23384 [01:07<00:03, 269.71it/s] 97%|█████████▋| 22589/23384 [01:07<00:01, 419.88it/s] 97%|█████████▋| 22657/23384 [01:07<00:01, 451.69it/s] 98%|█████████▊| 22806/23384 [01:07<00:00, 723.29it/s] 98%|█████████▊| 22887/23384 [01:07<00:00, 716.10it/s] 98%|█████████▊| 22963/23384 [01:08<00:01, 281.07it/s] 98%|█████████▊| 23019/23384 [01:08<00:01, 225.79it/s] 99%|█████████▊| 23063/23384 [01:09<00:01, 206.76it/s] 99%|█████████▉| 23098/23384 [01:09<00:01, 176.79it/s] 99%|█████████▉| 23126/23384 [01:09<00:01, 172.02it/s] 99%|█████████▉| 23150/23384 [01:09<00:01, 179.16it/s] 99%|█████████▉| 23212/23384 [01:09<00:00, 244.07it/s] 99%|█████████▉| 23255/23384 [01:09<00:00, 274.84it/s]100%|█████████▉| 23303/23384 [01:10<00:00, 316.31it/s]100%|█████████▉| 23342/23384 [01:10<00:00, 255.10it/s]100%|██████████| 23384/23384 [01:10<00:00, 332.24it/s]
Completing loading t2m dataset
Calculating dataset hash:   0%|          | 0/24546 [00:00<?, ?it/s]Calculating dataset hash:   5%|▍         | 1212/24546 [00:00<00:01, 12114.00it/s]Calculating dataset hash:  10%|▉         | 2424/24546 [00:00<00:02, 10482.66it/s]Calculating dataset hash:  14%|█▍        | 3487/24546 [00:00<00:02, 9664.98it/s] Calculating dataset hash:  18%|█▊        | 4464/24546 [00:00<00:02, 9129.75it/s]Calculating dataset hash:  22%|██▏       | 5383/24546 [00:00<00:02, 8682.99it/s]Calculating dataset hash:  25%|██▌       | 6255/24546 [00:00<00:02, 8286.03it/s]Calculating dataset hash:  29%|██▉       | 7086/24546 [00:00<00:02, 8068.67it/s]Calculating dataset hash:  32%|███▏      | 7894/24546 [00:00<00:02, 7973.08it/s]Calculating dataset hash:  35%|███▌      | 8691/24546 [00:01<00:02, 7783.12it/s]Calculating dataset hash:  39%|███▊      | 9469/24546 [00:01<00:01, 7577.96it/s]Calculating dataset hash:  42%|████▏     | 10227/24546 [00:01<00:01, 7363.42it/s]Calculating dataset hash:  45%|████▍     | 10963/24546 [00:01<00:01, 7106.23it/s]Calculating dataset hash:  48%|████▊     | 11674/24546 [00:01<00:01, 6876.08it/s]Calculating dataset hash:  50%|█████     | 12362/24546 [00:01<00:01, 6619.35it/s]Calculating dataset hash:  53%|█████▎    | 13025/24546 [00:01<00:01, 6379.39it/s]Calculating dataset hash:  56%|█████▌    | 13664/24546 [00:01<00:01, 6205.47it/s]Calculating dataset hash:  58%|█████▊    | 14285/24546 [00:01<00:01, 5948.56it/s]Calculating dataset hash:  61%|██████    | 14881/24546 [00:02<00:01, 5746.30it/s]Calculating dataset hash:  63%|██████▎   | 15457/24546 [00:02<00:01, 5489.67it/s]Calculating dataset hash:  65%|██████▌   | 16007/24546 [00:02<00:01, 5328.14it/s]Calculating dataset hash:  67%|██████▋   | 16541/24546 [00:02<00:01, 4913.82it/s]Calculating dataset hash:  69%|██████▉   | 17037/24546 [00:02<00:01, 4469.39it/s]Calculating dataset hash:  71%|███████▏  | 17492/24546 [00:02<00:01, 4178.57it/s]Calculating dataset hash:  73%|███████▎  | 18014/24546 [00:02<00:01, 4442.89it/s]Calculating dataset hash:  76%|███████▌  | 18615/24546 [00:02<00:01, 4859.92it/s]Calculating dataset hash:  78%|███████▊  | 19216/24546 [00:02<00:01, 5175.33it/s]Calculating dataset hash:  81%|████████  | 19816/24546 [00:03<00:00, 5406.00it/s]Calculating dataset hash:  83%|████████▎ | 20417/24546 [00:03<00:00, 5578.21it/s]Calculating dataset hash:  86%|████████▌ | 21019/24546 [00:03<00:00, 5705.05it/s]Calculating dataset hash:  88%|████████▊ | 21620/24546 [00:03<00:00, 5792.64it/s]Calculating dataset hash:  91%|█████████ | 22220/24546 [00:03<00:00, 5853.01it/s]Calculating dataset hash:  93%|█████████▎| 22821/24546 [00:03<00:00, 5896.89it/s]Calculating dataset hash:  95%|█████████▌| 23422/24546 [00:03<00:00, 5927.45it/s]Calculating dataset hash:  98%|█████████▊| 24022/24546 [00:03<00:00, 5946.46it/s]Calculating dataset hash: 100%|██████████| 24546/24546 [00:03<00:00, 6379.60it/s]
[Cache]  读取已有缓存: ./text_cache/t2m/train/t5/raw_embeds.pt

Initializing model ...
Namespace(name='ant_t2m', dataset_name='t2m', feat_bias=5, checkpoints_dir='./checkpoints', log_every=500, save_interval=5000, num_layers=8, latent_dim=512, text_latent_dim=256, time_dim=512, base_dim=512, dim_mults=[2, 2, 2, 2], no_eff=False, no_adagn=False, diffusion_steps=1000, prediction_type='sample', text_encoder_type='t5', abstractor=True, disable_sta=False, laten_size=77, dropout=0.1, seed=0, num_train_steps=150000, lr=0.0001, decay_rate=0.9, update_lr_steps=5000, cond_mask_prob=0.1, clip_grad_norm=1, weight_decay=0.01, batch_size=64, beta_schedule='linear', enable_trace=False, use_text_cache=True, is_continue=False, continue_ckpt='latest.tar', opt_path='', which_ckpt='latest_120000', evaluator_dir='./data/pretrained_models', eval_meta_dir='./data', glove_dir='./data/glove', num_inference_steps=10, diffuser_name='dpmsolver', no_ema=False, no_fp16=False, enable_cfg_scheduler=False, cfg_scheduler_type='none', replication_times=20, batch_size_eval=32, diversity_times=300, mm_num_samples=100, mm_num_repeats=30, mm_num_times=10, evl_mode='fid', cfg_scale=2.5, model_ema=False, model_ema_steps=32, model_ema_decay=0.9999, unit_length=4, max_text_len=20, text_enc_mod='bigru', estimator_mod='bigru', dim_text_hidden=512, dim_att_vec=512, dim_z=128, dim_movement_enc_hidden=512, dim_movement_dec_hidden=512, dim_movement_latent=512, dim_word=300, dim_pos_ohot=15, dim_motion_hidden=1024, dim_coemb_hidden=512, joints_num=22, dim_pose=263, max_motion_length=196, radius=4, fps=20, device=device(type='cuda'), is_train=True, save_root='./checkpoints/t2m/ant_t2m', model_dir='./checkpoints/t2m/ant_t2m/model', meta_dir='./checkpoints/t2m/ant_t2m/meta')
Creating UNet with text encoder: 't5'
Loading T5 model from: ./T5
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00, 34.15it/s]
You are using the default legacy behaviour of the <class 'transformers.models.t5.tokenization_t5.T5Tokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
Building STA connector.
[CondUnet1D] Dims: [263, 1024, 1024, 1024, 1024], Multipliers: [2, 2, 2, 2]
T2M-Unet model created successfully.
Finish building Model.

Model trainable parameters: 301129991
Model total parameters: 1524657415
Diffusion_config:
 FrozenDict([('num_train_timesteps', 1000), ('beta_start', 0.0001), ('beta_end', 0.02), ('beta_schedule', 'linear'), ('trained_betas', None), ('variance_type', 'fixed_small'), ('clip_sample', False), ('prediction_type', 'sample'), ('thresholding', False), ('dynamic_thresholding_ratio', 0.995), ('clip_sample_range', 1.0), ('sample_max_value', 1.0), ('timestep_spacing', 'leading'), ('steps_offset', 0), ('rescale_betas_zero_snr', False), ('_use_default_values', ['clip_sample_range', 'beta_end', 'trained_betas', 'beta_start', 'steps_offset', 'thresholding', 'sample_max_value', 'dynamic_thresholding_ratio', 'rescale_betas_zero_snr', 'timestep_spacing'])])
Start experiment: 2025-08-27_05:16:05
Setting up evaluation components...

Loading Evaluation Model Wrapper (Epoch 28) Completed!!

 Loading gt_eval mode HumanML3D dataset ...
./data/t2m_std.npy
  0%|          | 0/1460 [00:00<?, ?it/s]  0%|          | 7/1460 [00:00<00:21, 68.56it/s]  2%|▏         | 24/1460 [00:00<00:11, 127.43it/s]  3%|▎         | 37/1460 [00:00<00:12, 111.61it/s]  4%|▎         | 52/1460 [00:00<00:11, 124.05it/s]  4%|▍         | 65/1460 [00:00<00:12, 115.14it/s]  5%|▌         | 79/1460 [00:00<00:11, 121.21it/s]  7%|▋         | 105/1460 [00:00<00:08, 163.01it/s]  9%|▊         | 127/1460 [00:00<00:07, 179.34it/s] 10%|█         | 146/1460 [00:01<00:08, 157.41it/s] 11%|█         | 163/1460 [00:01<00:09, 139.22it/s] 12%|█▏        | 178/1460 [00:01<00:09, 134.88it/s] 13%|█▎        | 193/1460 [00:01<00:09, 129.73it/s] 14%|█▍        | 207/1460 [00:01<00:11, 109.46it/s] 16%|█▌        | 227/1460 [00:01<00:10, 122.50it/s] 16%|█▋        | 240/1460 [00:01<00:09, 122.66it/s] 17%|█▋        | 253/1460 [00:01<00:09, 121.97it/s] 19%|█▉        | 275/1460 [00:02<00:08, 143.12it/s] 20%|█▉        | 290/1460 [00:02<00:09, 128.97it/s] 21%|██        | 304/1460 [00:02<00:08, 131.33it/s] 22%|██▏       | 318/1460 [00:02<00:09, 117.23it/s] 23%|██▎       | 334/1460 [00:02<00:09, 124.79it/s] 24%|██▍       | 347/1460 [00:02<00:09, 119.45it/s] 25%|██▍       | 364/1460 [00:02<00:08, 132.43it/s] 26%|██▌       | 378/1460 [00:02<00:08, 133.42it/s] 27%|██▋       | 399/1460 [00:03<00:06, 152.25it/s] 28%|██▊       | 415/1460 [00:03<00:07, 140.18it/s] 30%|██▉       | 436/1460 [00:03<00:06, 152.79it/s] 31%|███▏      | 459/1460 [00:03<00:05, 171.33it/s] 33%|███▎      | 481/1460 [00:03<00:05, 184.58it/s] 35%|███▍      | 505/1460 [00:03<00:05, 190.80it/s] 36%|███▌      | 525/1460 [00:03<00:05, 183.99it/s] 37%|███▋      | 546/1460 [00:03<00:04, 186.77it/s] 39%|███▉      | 569/1460 [00:03<00:04, 197.11it/s] 40%|████      | 589/1460 [00:04<00:04, 197.78it/s] 42%|████▏     | 609/1460 [00:04<00:04, 170.93it/s] 43%|████▎     | 627/1460 [00:04<00:05, 156.15it/s] 44%|████▍     | 644/1460 [00:04<00:05, 158.76it/s] 46%|████▌     | 670/1460 [00:04<00:04, 177.51it/s] 47%|████▋     | 689/1460 [00:04<00:04, 165.55it/s] 49%|████▉     | 719/1460 [00:04<00:03, 197.91it/s] 51%|█████     | 740/1460 [00:04<00:03, 187.59it/s] 54%|█████▍    | 785/1460 [00:05<00:02, 251.90it/s] 57%|█████▋    | 831/1460 [00:05<00:02, 299.60it/s] 61%|██████    | 889/1460 [00:05<00:01, 375.64it/s] 64%|██████▍   | 941/1460 [00:05<00:01, 415.67it/s] 67%|██████▋   | 984/1460 [00:05<00:01, 339.62it/s] 70%|███████   | 1022/1460 [00:05<00:01, 334.69it/s] 72%|███████▏  | 1058/1460 [00:05<00:01, 336.46it/s] 76%|███████▌  | 1106/1460 [00:05<00:00, 373.87it/s] 78%|███████▊  | 1145/1460 [00:05<00:00, 370.27it/s] 81%|████████  | 1184/1460 [00:06<00:00, 367.65it/s] 84%|████████▎ | 1222/1460 [00:06<00:00, 341.60it/s] 87%|████████▋ | 1265/1460 [00:06<00:00, 353.46it/s] 89%|████████▉ | 1301/1460 [00:06<00:00, 351.97it/s] 92%|█████████▏| 1340/1460 [00:06<00:00, 361.99it/s] 94%|█████████▍| 1377/1460 [00:06<00:00, 316.82it/s] 98%|█████████▊| 1428/1460 [00:06<00:00, 359.28it/s]100%|██████████| 1460/1460 [00:06<00:00, 215.11it/s]
Completing loading t2m dataset
Calculating dataset hash:   0%|          | 0/1530 [00:00<?, ?it/s]Calculating dataset hash:  22%|██▏       | 338/1530 [00:00<00:00, 3370.52it/s]Calculating dataset hash:  44%|████▍     | 676/1530 [00:00<00:00, 3264.79it/s]Calculating dataset hash:  66%|██████▌   | 1003/1530 [00:00<00:00, 3083.17it/s]Calculating dataset hash:  86%|████████▌ | 1313/1530 [00:00<00:00, 2995.79it/s]Calculating dataset hash: 100%|██████████| 1530/1530 [00:00<00:00, 3009.55it/s]
[Cache]  读取已有缓存: ./text_cache/t2m/val/t5/raw_embeds.pt

 Loading eval mode HumanML3D dataset ...
./checkpoints/t2m/ant_t2m/meta/std.npy
  0%|          | 0/1460 [00:00<?, ?it/s] 15%|█▍        | 216/1460 [00:00<00:00, 2157.09it/s] 30%|███       | 439/1460 [00:00<00:00, 2194.92it/s] 46%|████▌     | 665/1460 [00:00<00:00, 2224.52it/s] 61%|██████    | 891/1460 [00:00<00:00, 2235.38it/s] 78%|███████▊  | 1133/1460 [00:00<00:00, 2301.43it/s] 93%|█████████▎| 1364/1460 [00:00<00:00, 2302.69it/s]100%|██████████| 1460/1460 [00:00<00:00, 2270.35it/s]
Completing loading t2m dataset
Evaluation components are ready.
Need to train for 392 epochs....
Traceback (most recent call last):
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/subprocess.py", line 1209, in wait
    return self._wait(timeout=timeout)
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/subprocess.py", line 1959, in _wait
    (pid, sts) = self._try_wait(0)
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/subprocess.py", line 1917, in _try_wait
    (pid, sts) = os.waitpid(self.pid, wait_flags)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/kuimou/miniconda3/envs/openANT_test/bin/accelerate", line 8, in <module>
    sys.exit(main())
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/site-packages/accelerate/commands/accelerate_cli.py", line 50, in main
    args.func(args)
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/site-packages/accelerate/commands/launch.py", line 1199, in launch_command
    simple_launcher(args)
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/site-packages/accelerate/commands/launch.py", line 782, in simple_launcher
    process.wait()
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/subprocess.py", line 1222, in wait
    self._wait(timeout=sigint_timeout)
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/subprocess.py", line 1953, in _wait
    time.sleep(delay)
KeyboardInterrupt
Traceback (most recent call last):
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/data/kuimou/openANT/scripts/train/train.py", line 93, in <module>
    trainer.train(train_datasetloader)
  File "/data/kuimou/openANT/trainers/ddpm_trainer.py", line 307, in train
    self.forward(batch_data)
  File "/data/kuimou/openANT/trainers/ddpm_trainer.py", line 112, in forward
    self.prediction = self.model(
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/kuimou/openANT/models/t2m_unet.py", line 181, in forward
    out_pad = self.unet(
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/kuimou/openANT/models/submodules/unet_1d.py", line 71, in forward
    x = block1(x, temb, cond, cond_indices)
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/kuimou/openANT/models/submodules/cond_conv_block.py", line 43, in forward
    x = self.cross_attn(x, cond, cond_indices, return_weights=False)
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/kuimou/openANT/models/submodules/attention.py", line 137, in forward
    attn_output, weights = self.cross_attention(x_cond, cond, return_weights=True)
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/data/kuimou/openANT/models/submodules/attention.py", line 90, in forward
    context = torch.einsum('bnhk,bnhv->bhkv', key, value)
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/site-packages/torch/functional.py", line 422, in einsum
    return _VF.einsum(equation, operands)  # type: ignore[attr-defined]
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/site-packages/torch/fx/traceback.py", line 189, in format_stack
    return traceback.format_list(traceback.extract_stack()[:-1])
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/traceback.py", line 227, in extract_stack
    stack = StackSummary.extract(walk_stack(f), limit=limit)
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/traceback.py", line 379, in extract
    linecache.checkcache(filename)
  File "/data/kuimou/miniconda3/envs/openANT_test/lib/python3.10/linecache.py", line 72, in checkcache
    stat = os.stat(fullname)
KeyboardInterrupt
